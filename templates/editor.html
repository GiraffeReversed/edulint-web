{% extends 'base.html' %}

{% block head %}

<script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.1/codemirror.min.js"
  integrity="sha512-UczTlJPfdNqI2hb02wot6lMzwUNtjywtRSz+Ut/Q+aR0/D6tLkIxRB+GgjxjX6PSA+0KrQJuwn4z6J+3EExilg=="
  crossorigin="anonymous" referrerpolicy="no-referrer"></script>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.1/codemirror.min.css"
  integrity="sha512-uf06llspW44/LZpHzHT6qBOIVODjWtv4MxCricRxkzvopAlSWnTf6hpZTFxuuZcuNE9CBQhqE0Seu1CoRk84nQ=="
  crossorigin="anonymous" referrerpolicy="no-referrer" />
<script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.1/addon/display/placeholder.min.js"
  integrity="sha512-RO2holrH2sTvI9eanK0s+luhPF+J7sdzmk0lMosgrSaUSEjRUfyFiSaERSXHPcIJfQNqeVermdLvQRqUe4sSIQ=="
  crossorigin="anonymous" referrerpolicy="no-referrer"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.1/mode/python/python.min.js"
  integrity="sha512-/mavDpedrvPG/0Grj2Ughxte/fsm42ZmZWWpHz1jCbzd5ECv8CB7PomGtw0NAnhHmE/lkDFkRMupjoohbKNA1Q=="
  crossorigin="anonymous" referrerpolicy="no-referrer"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.1/addon/selection/active-line.min.js"
  integrity="sha512-UNVAZmixdjeBtJVQcH5eSKXuVdzbSV6rzfTfNVyYWUIIDCdI9/G8/Z/nWplnSHXXxz9U8TA1BiJ1trK7abL/dg=="
  crossorigin="anonymous" referrerpolicy="no-referrer"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.1/addon/display/rulers.min.js"
  integrity="sha512-sF+AF3zpVOHMt4f4mN1dVS2/Hon6pr/7h1gc7rDHtga0SeD9z0UiL1J0k3umDFEz5qkY06ARcNzi45NkJ9GsYw=="
  crossorigin="anonymous" referrerpolicy="no-referrer"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/split.js/1.6.2/split.min.js"
  integrity="sha512-to2k78YjoNUq8+hnJS8AwFg/nrLRFLdYYalb18SlcsFRXavCOTfBF3lNyplKkLJeB8YjKVTb1FPHGSy9sXfSdg=="
  crossorigin="anonymous" referrerpolicy="no-referrer"></script>
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/code-mirror-themes@1.0.0/themes/coda.min.css">
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/code-mirror-themes@1.0.0/themes/sunburst.min.css">

<script src="/static/handle_problems.js"></script>

{% endblock %}

{% block versions %}

<li class="nav-item d-flex align-items-center">
  <select class="form-select form-select-sm" aria-label=".form-select-sm" id="versionsSelect">
    {% for version in versions %}
    <option value="{{ version }}">v{{ version }}</option>
    {% endfor %}
  </select>
</li>


{% endblock %}

{% block content %}

<div class="d-flex flex-row flex-fill" id="analysis-block">
  <div id="code-block" class="d-flex flex-column m-3 me-2 mt-1">
    <div class="d-flex flex-row justify-content-between">
      <h5>Code</h5>
      <small id="keybind" hidden><kbd class="bg-secondary"><kbd class="bg-secondary">ctrl</kbd> + <kbd
            class="bg-secondary">D</kbd></kbd> to mark current line as solved</small>
    </div>

    <textarea name="code" id="code" placeholder="Enter your code here">{{textarea}}</textarea>

    <div class="input-group pt-3 mb-2">
      <input type="file" class="form-control" id="inputFile" aria-describedby="analysisSubmit" aria-label="Upload"
        accept=".py">
      <button class="btn btn-secondary" type="button" id="downloadFile">
        <a id="downloadFileAux"></a>
        Download
      </button>
      <button class="btn btn-primary" type="button" id="analysisSubmit">
        <span class="spinner-border spinner-border-sm" role="status" aria-hidden="true" hidden></span>
        Check
      </button>
    </div>
    <div>
      <p class="text-muted small mb-0 text-center">Problems? Thoughts? Improvement suggestions?
        <a href="https://docs.google.com/forms/d/e/1FAIpQLSfiQDmLX_KdOdoGJKC8qhNfYNG6O7sNiNk-x7as7H02DI7XhQ/viewform"
          target="_blank" class="link-secondary">
          Let me know.</a>
      </p>
    </div>
  </div>
  <div id="problems-block" class="d-flex flex-column m-3 ms-0 mt-1">
    <h5 class="ms-2">Problems</h5>
    <div class="pt-1 pe-1 ps-2">
      <div class="alert alert-success" role="alert" id="alertNoProblems" style="display: none">
        I have found no problems with this code :)
      </div>
      <div class="alert alert-danger" role="alert" id="alertNot200" style="display: none">
        Server responded with the status code <span></span>.
      </div>
      <div id="problems">
      </div>
    </div>
  </div>

  <div class="position-fixed bottom-0 end-0 p-3 pb-3 toast-container" style="z-index: 11">

    <div id="toastNoSave" class="toast align-items-center" role="alert" aria-live="assertive" aria-atomic="true">
      <div class="d-flex">
        <div class="toast-body">
          <span>
            <kbd class="bg-secondary"><kbd class="bg-secondary">ctrl</kbd> + <kbd class="bg-secondary">S</kbd></kbd>
            does nothing on purpose. <a class="link-secondary" href="/faq#ctrl-s-captured">Here's why.</a>
          </span>
        </div>
        <button type="button" class="btn-close me-2 m-auto" data-bs-dismiss="toast" aria-label="Close"></button>
      </div>
    </div>

    <div id="toastLineDeleted" class="toast align-items-center" role="alert" aria-live="assertive" aria-atomic="true">
      <div class="d-flex">
        <div class="toast-body">
          Line with this problem has been removed.
        </div>
        <button type="button" class="btn-close me-2 m-auto" data-bs-dismiss="toast" aria-label="Close"></button>
      </div>
    </div>

    <div id="toastIncorrectFiletype" class="toast align-items-center border-0" role="alert" aria-live="assertive"
      aria-atomic="true">
      <div class="alert alert-danger alert-dismissible fade show mb-0" role="alert">
        Select a <span class="font-monospace">.py</span> file.
        <button type="button" class="btn-close me-2 m-auto" data-bs-dismiss="toast" aria-label="Close"></button>
      </div>
    </div>

    <div id="toastUnnecessaryDownload" class="toast align-items-center" role="alert" aria-live="assertive"
      aria-atomic="true">
      <div class="d-flex">
        <div class="toast-body">
          Unnecessary download of empty file.
        </div>
        <button type="button" class="btn-close me-2 m-auto" data-bs-dismiss="toast" aria-label="Close"></button>
      </div>
    </div>

    <div id="toastDangerousDownload" class="toast align-items-center border-0" role="alert" aria-live="assertive"
      aria-atomic="true" data-bs-delay="7500">
      <div class="alert alert-warning alert-dismissible fade show mb-0" role="alert" data-autohide="false">
        Is your browser warning you about a harmful file? The file is fine, but <a class="link-secondary"
          href="/faq#download-warning">here is what's happening.</a>
        <button type="button" class="btn-close me-2 m-auto" data-bs-dismiss="toast" aria-label="Close"></button>
      </div>
    </div>

    <div id="toastPrivacyPolicy" class="toast align-items-center" role="alert" aria-live="assertive" aria-atomic="true"
      data-bs-autohide="false">
      <div class="d-flex">
        <div class="toast-body">
          By clicking Check, you are agreeing with <a href="{{ url_for('web.privacy') }}">Privacy Policy</a>.
        </div>
        <button type="button" class="btn-close me-2 m-auto" data-bs-dismiss="toast" aria-label="Close"></button>
      </div>
    </div>

  </div>
</div>

{% endblock %}